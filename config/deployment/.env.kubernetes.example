# =============================================================================
# KUBERNETES DEPLOYMENT ENVIRONMENT VARIABLES
# =============================================================================
# These environment variables should be configured via Kubernetes ConfigMaps
# and Secrets. This file serves as documentation for required variables.

# =============================================================================
# DEPLOYMENT CONFIGURATION
# =============================================================================

# Environment (staging, production)
API_ENV=production

# Kubernetes deployment indicator (automatically set by Kubernetes)
# KUBERNETES_SERVICE_HOST=kubernetes.default.svc.cluster.local

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================

# Application configuration
API_APP_NAME="Production API Framework"
API_VERSION="0.1.0"
API_DEBUG=false
API_LOG_LEVEL=INFO
API_LOG_FORMAT=json

# Server configuration (Kubernetes networking)
API_HOST=0.0.0.0
API_PORT=8000

# API Configuration
API_PREFIX="/api"
API_VERSION_PREFIX="/v1"

# =============================================================================
# DATABASE CONFIGURATION (Kubernetes Services)
# =============================================================================

# Database connection URL (using Kubernetes service names or external endpoints)
# Should be configured via Kubernetes Secret
API_DATABASE_URL="postgresql+asyncpg://api_user:${DB_PASSWORD}@postgres-service:5432/api_db"

# Database connection pool settings
API_DB_POOL_SIZE=20
API_DB_MAX_OVERFLOW=40
API_DB_POOL_TIMEOUT=30
API_DB_POOL_RECYCLE=3600

# =============================================================================
# REDIS CONFIGURATION (Kubernetes Services)
# =============================================================================

# Redis connection URL (using Kubernetes service names)
API_REDIS_URL="redis://redis-service:6379/0"

# Redis connection pool settings
API_REDIS_MAX_CONNECTIONS=20
API_REDIS_RETRY_ON_TIMEOUT=true

# =============================================================================
# SECURITY CONFIGURATION (Kubernetes Secrets)
# =============================================================================

# JWT Secret Key (MUST be configured via Kubernetes Secret)
# API_SECRET_KEY should be mounted from a Secret volume
API_SECRET_KEY="${JWT_SECRET_KEY}"

# JWT Configuration
API_ACCESS_TOKEN_EXPIRE_MINUTES=30
API_REFRESH_TOKEN_EXPIRE_DAYS=7
API_ALGORITHM="HS256"

# =============================================================================
# CORS CONFIGURATION (Kubernetes ConfigMap)
# =============================================================================

# CORS allowed origins (should be configured via ConfigMap)
# API_CORS_ORIGINS should be set based on your ingress configuration
API_CORS_ORIGINS="${ALLOWED_ORIGINS}"

# CORS configuration
API_CORS_ALLOW_CREDENTIALS=true
API_CORS_ALLOW_METHODS="GET,POST,PUT,DELETE,OPTIONS"
API_CORS_ALLOW_HEADERS="*"

# =============================================================================
# MONITORING AND OBSERVABILITY
# =============================================================================

# Sentry DSN for error tracking (configure via Kubernetes Secret)
API_SENTRY_DSN="${SENTRY_DSN}"

# Sentry environment
API_SENTRY_ENVIRONMENT="kubernetes"

# Sentry sample rate (production values)
API_SENTRY_TRACES_SAMPLE_RATE=0.1
API_SENTRY_SAMPLE_RATE=0.1

# Prometheus metrics
API_METRICS_ENABLED=true
API_METRICS_PATH="/metrics"

# =============================================================================
# KUBERNETES-SPECIFIC SETTINGS
# =============================================================================

# Worker configuration (optimized for Kubernetes)
API_WORKERS=4
API_WORKER_CONNECTIONS=1000

# Request timeout
API_REQUEST_TIMEOUT=30

# Health check configuration (optimized for Kubernetes probes)
API_HEALTH_CHECK_TIMEOUT=5
API_SHUTDOWN_TIMEOUT=30

# Graceful shutdown settings
API_SHUTDOWN_WAIT_FOR_CONNECTIONS=true
API_SHUTDOWN_FORCE_AFTER_TIMEOUT=true

# =============================================================================
# FEATURE FLAGS (Kubernetes ConfigMap)
# =============================================================================

# Feature toggles (configure via ConfigMap)
API_FEATURE_REGISTRATION_ENABLED=true
API_FEATURE_EMAIL_VERIFICATION=true
API_FEATURE_SOCIAL_LOGIN=true

# =============================================================================
# OBSERVABILITY SETTINGS
# =============================================================================

# Request/response logging (production settings)
API_OBSERVABILITY_LOG_REQUESTS=true
API_OBSERVABILITY_LOG_RESPONSES=false
API_OBSERVABILITY_LOG_REQUEST_BODY=false
API_OBSERVABILITY_LOG_RESPONSE_BODY=false
API_OBSERVABILITY_MASK_SENSITIVE_DATA=true
API_OBSERVABILITY_TRACK_PERFORMANCE=true

# Structured logging
API_MASK_SENSITIVE_LOGS=true

# =============================================================================
# RATE LIMITING
# =============================================================================

# Rate limiting configuration
API_RATE_LIMIT_ENABLED=true
API_RATE_LIMIT_REQUESTS=100
API_RATE_LIMIT_WINDOW=60

# =============================================================================
# PERFORMANCE SETTINGS
# =============================================================================

# Request size limits
API_MAX_REQUEST_SIZE=5242880  # 5MB

# Performance settings
API_REQUEST_TIMEOUT=30