# =============================================================================
# GOOGLE CLOUD RUN DEPLOYMENT ENVIRONMENT VARIABLES
# =============================================================================
# These environment variables should be configured via Cloud Run service
# environment variables or Secret Manager. This file serves as documentation.

# =============================================================================
# DEPLOYMENT CONFIGURATION
# =============================================================================

# Environment (staging, production)
API_ENV=production

# Cloud Run specific environment variables (automatically set)
# K_SERVICE=your-service-name
# K_REVISION=your-revision
# K_CONFIGURATION=your-configuration
# GOOGLE_CLOUD_PROJECT=your-project-id

# Port (automatically set by Cloud Run)
PORT=8080

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================

# Application configuration
API_APP_NAME="Production API Framework"
API_VERSION="0.1.0"
API_DEBUG=false
API_LOG_LEVEL=INFO
API_LOG_FORMAT=json

# Server configuration (Cloud Run networking)
API_HOST=0.0.0.0
# API_PORT will be set from PORT environment variable

# API Configuration
API_PREFIX="/api"
API_VERSION_PREFIX="/v1"

# =============================================================================
# DATABASE CONFIGURATION (Cloud SQL)
# =============================================================================

# Database connection URL (using Cloud SQL connection)
# Should be configured via Secret Manager
API_DATABASE_URL="postgresql+asyncpg://api_user:${DB_PASSWORD}@/api_db?host=/cloudsql/${CLOUD_SQL_CONNECTION_NAME}"

# Alternative: TCP connection to Cloud SQL
# API_DATABASE_URL="postgresql+asyncpg://api_user:${DB_PASSWORD}@${CLOUD_SQL_IP}:5432/api_db"

# Database connection pool settings (optimized for Cloud Run)
API_DB_POOL_SIZE=5
API_DB_MAX_OVERFLOW=10
API_DB_POOL_TIMEOUT=30
API_DB_POOL_RECYCLE=3600

# =============================================================================
# REDIS CONFIGURATION (Memorystore)
# =============================================================================

# Redis connection URL (using Memorystore for Redis)
API_REDIS_URL="redis://${REDIS_HOST}:6379/0"

# Redis connection pool settings
API_REDIS_MAX_CONNECTIONS=10
API_REDIS_RETRY_ON_TIMEOUT=true

# =============================================================================
# SECURITY CONFIGURATION (Secret Manager)
# =============================================================================

# JWT Secret Key (MUST be configured via Secret Manager)
API_SECRET_KEY="${JWT_SECRET_KEY}"

# JWT Configuration
API_ACCESS_TOKEN_EXPIRE_MINUTES=30
API_REFRESH_TOKEN_EXPIRE_DAYS=7
API_ALGORITHM="HS256"

# =============================================================================
# CORS CONFIGURATION
# =============================================================================

# CORS allowed origins (configure based on your domain)
API_CORS_ORIGINS="${ALLOWED_ORIGINS}"

# CORS configuration
API_CORS_ALLOW_CREDENTIALS=true
API_CORS_ALLOW_METHODS="GET,POST,PUT,DELETE,OPTIONS"
API_CORS_ALLOW_HEADERS="*"

# =============================================================================
# MONITORING AND OBSERVABILITY
# =============================================================================

# Sentry DSN for error tracking (configure via Secret Manager)
API_SENTRY_DSN="${SENTRY_DSN}"

# Sentry environment
API_SENTRY_ENVIRONMENT="cloud-run"

# Sentry sample rate (production values)
API_SENTRY_TRACES_SAMPLE_RATE=0.1
API_SENTRY_SAMPLE_RATE=0.1

# Prometheus metrics
API_METRICS_ENABLED=true
API_METRICS_PATH="/metrics"

# =============================================================================
# CLOUD RUN SPECIFIC SETTINGS
# =============================================================================

# Worker configuration (Cloud Run handles scaling)
API_WORKERS=1

# Request timeout (must be <= Cloud Run timeout)
API_REQUEST_TIMEOUT=30

# Health check configuration
API_HEALTH_CHECK_TIMEOUT=5
API_SHUTDOWN_TIMEOUT=10

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Feature toggles
API_FEATURE_REGISTRATION_ENABLED=true
API_FEATURE_EMAIL_VERIFICATION=true
API_FEATURE_SOCIAL_LOGIN=true

# =============================================================================
# OBSERVABILITY SETTINGS
# =============================================================================

# Request/response logging (production settings)
API_OBSERVABILITY_LOG_REQUESTS=true
API_OBSERVABILITY_LOG_RESPONSES=false
API_OBSERVABILITY_LOG_REQUEST_BODY=false
API_OBSERVABILITY_LOG_RESPONSE_BODY=false
API_OBSERVABILITY_MASK_SENSITIVE_DATA=true
API_OBSERVABILITY_TRACK_PERFORMANCE=true

# Structured logging (integrates with Cloud Logging)
API_MASK_SENSITIVE_LOGS=true

# =============================================================================
# RATE LIMITING
# =============================================================================

# Rate limiting configuration
API_RATE_LIMIT_ENABLED=true
API_RATE_LIMIT_REQUESTS=100
API_RATE_LIMIT_WINDOW=60

# =============================================================================
# PERFORMANCE SETTINGS
# =============================================================================

# Request size limits
API_MAX_REQUEST_SIZE=5242880  # 5MB

# =============================================================================
# GOOGLE CLOUD SPECIFIC
# =============================================================================

# Cloud SQL connection name (for socket connection)
# CLOUD_SQL_CONNECTION_NAME=project:region:instance

# Cloud SQL IP (for TCP connection)
# CLOUD_SQL_IP=10.x.x.x

# Redis host (Memorystore)
# REDIS_HOST=10.x.x.x

# Google Cloud project settings
# GOOGLE_CLOUD_PROJECT=your-project-id